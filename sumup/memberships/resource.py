# Code generated by `py-sdk-gen`. DO NOT EDIT.
from .._service import Resource, AsyncResource, HeaderTypes
from .._exceptions import APIError
from .types import (
    Membership,
    MembershipStatus,
    ResourceType,
)
import httpx
import typing
import pydantic


class ListMembershipsParams(pydantic.BaseModel):
    """
    ListMembershipsParams: query parameters for ListMemberships
    """

    kind: typing.Optional[ResourceType] = None
    """
	The type of the membership resource.
	Possible values are:
	* `merchant` - merchant account(s)
	* `organization` - organization(s)
	"""

    limit: typing.Optional[int] = None

    offset: typing.Optional[int] = None

    resource_attributes_sandbox: typing.Optional[bool] = pydantic.Field(
        default=None,
        serialization_alias="resource.attributes.sandbox",
        validation_alias=pydantic.AliasChoices(
            "resource.attributes.sandbox", "resource_attributes_sandbox"
        ),
    )

    resource_name: typing.Optional[str] = pydantic.Field(
        default=None,
        serialization_alias="resource.name",
        validation_alias=pydantic.AliasChoices("resource.name", "resource_name"),
    )

    resource_parent_id: typing.Optional[str] = pydantic.Field(
        default=None,
        serialization_alias="resource.parent.id",
        validation_alias=pydantic.AliasChoices("resource.parent.id", "resource_parent_id"),
    )

    resource_parent_type: typing.Optional[ResourceType] = pydantic.Field(
        default=None,
        serialization_alias="resource.parent.type",
        validation_alias=pydantic.AliasChoices("resource.parent.type", "resource_parent_type"),
    )

    resource_type: typing.Optional[ResourceType] = pydantic.Field(
        default=None,
        serialization_alias="resource.type",
        validation_alias=pydantic.AliasChoices("resource.type", "resource_type"),
    )
    """
	The type of the membership resource.
	Possible values are:
	* `merchant` - merchant account(s)
	* `organization` - organization(s)
	"""

    roles: typing.Optional[list[str]] = None

    status: typing.Optional[MembershipStatus] = None
    """
	The status of the membership.
	"""


class ListMemberships200Response(pydantic.BaseModel):
    """
    ListMemberships200Response is a schema definition.
    """

    items: list[Membership]

    total_count: int


class MembershipsResource(Resource):
    def __init__(self, client: httpx.Client):
        super().__init__(client)

    def list(
        self,
        params: typing.Optional[ListMembershipsParams] = None,
        headers: typing.Optional[HeaderTypes] = None,
    ) -> ListMemberships200Response:
        """
        List memberships

        List memberships of the current user.
        """
        resp = self._client.get(
            "/v0.1/memberships",
            params=params.model_dump(by_alias=True, exclude_none=True) if params else None,
            headers=headers,
        )
        if resp.status_code == 200:
            return pydantic.TypeAdapter(ListMemberships200Response).validate_python(resp.json())
        else:
            raise APIError("Unexpected response", status=resp.status_code, body=resp.text)


class AsyncMembershipsResource(AsyncResource):
    def __init__(self, client: httpx.AsyncClient):
        super().__init__(client)

    async def list(
        self,
        params: typing.Optional[ListMembershipsParams] = None,
        headers: typing.Optional[HeaderTypes] = None,
    ) -> ListMemberships200Response:
        """
        List memberships

        List memberships of the current user.
        """
        resp = await self._client.get(
            "/v0.1/memberships",
            params=params.model_dump(by_alias=True, exclude_none=True) if params else None,
            headers=headers,
        )
        if resp.status_code == 200:
            return pydantic.TypeAdapter(ListMemberships200Response).validate_python(resp.json())
        else:
            raise APIError("Unexpected response", status=resp.status_code, body=resp.text)
